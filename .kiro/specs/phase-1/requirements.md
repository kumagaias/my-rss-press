# 要件定義書 MVP

## はじめに

MyRSSPressは、RSSフィードを視覚的に魅力的な新聞スタイルのレイアウトに変換するWebアプリケーションです。ユーザーは興味のあるトピックを入力し、AIによるRSSフィード提案を受け取り、フィードを選択して、リアルな紙のテクスチャとインテリジェントな記事レイアウトを備えたパーソナライズされたデジタル新聞を生成します。システムは、本物の新聞デザインによる視覚的な没入感と、デモ環境に適した高速な生成時間を重視します。また、多言語対応により、ユーザーのブラウザ設定に基づいて日本語または英語でインターフェースを提供します。

## 用語集

- **MyRSSPressシステム**: フロントエンドインターフェース、バックエンド処理、AI統合を含む完全なWebアプリケーション
- **テーマキーワード**: ユーザーが提供する興味分野を表すテキスト入力（例：「Tech」「スポーツ」）
- **RSSフィード**: ウェブサイトからの配信コンテンツを含むWebフィード形式
- **フィード提案**: ユーザーのテーマに関連するRSSフィードURLのAI生成推薦
- **新聞ページ**: 新聞スタイルのレイアウトで記事を表示する生成された出力
- **記事重要度**: タイトルの長さ、画像の有無などの要素に基づいて視覚的な目立ち度を決定する計算されたメトリック
- **紙テクスチャ**: テクスチャとタイポグラフィを含む物理的な新聞の外観をシミュレートする視覚的スタイリング

- **生成プロセス**: フィード選択から新聞ページ作成までの完全なワークフロー
- **ロケール**: ユーザーの言語設定（日本語または英語）
- **統合ホーム画面**: 興味入力、フィード管理、人気の新聞表示を1つの画面に統合したインターフェース
- **新聞設定**: 新聞名、ユーザー名、公開/非公開設定を含む新聞のメタデータ
- **人気の新聞**: 他のユーザーが作成した公開新聞で、閲覧数順に表示されるもの

## 要件

### 要件1: 多言語対応

**ユーザーストーリー:** ユーザーとして、自分のブラウザ設定に基づいて適切な言語でインターフェースを表示したい。そうすることで、母国語で快適にアプリケーションを利用できる。

#### 受入基準

1. ユーザーがアプリケーションにアクセスしたとき、MyRSSPressシステムはブラウザの言語設定を検出しなければならない
2. ブラウザ言語が日本語のとき、MyRSSPressシステムは日本語のインターフェースを表示しなければならない
3. ブラウザ言語が日本語以外のとき、MyRSSPressシステムは英語のインターフェースを表示しなければならない
4. 言語が切り替わるとき、MyRSSPressシステムはすべてのUIテキスト、ラベル、メッセージを選択された言語で表示しなければならない
5. 日付を表示するとき、MyRSSPressシステムは選択された言語に適したロケール形式を使用しなければならない

### 要件2: 統合ホーム画面

**ユーザーストーリー:** ユーザーとして、1つの画面で興味の入力、フィード管理、人気の新聞閲覧を行いたい。そうすることで、効率的にアプリケーションを操作できる。

#### 受入基準

1. ユーザーがトップページにアクセスしたとき、MyRSSPressシステムは興味入力セクション、フィード管理セクション、人気の新聞セクションを含む統合画面を表示しなければならない
2. ユーザーが興味を入力したとき、MyRSSPressシステムはEnterキーまたはボタンクリックで送信を受け付けなければならない
3. ユーザーがRSSフィードURLを手動で入力したとき、MyRSSPressシステムはフィードリストに追加しなければならない
4. ユーザーがフィードを追加したとき、MyRSSPressシステムは重複するフィードの追加を防止しなければならない
5. ユーザーがフィードを削除したとき、MyRSSPressシステムはリストから即座に削除しなければならない

### 要件3: AIフィード提案

**ユーザーストーリー:** ユーザーとして、テーマに基づいたAI駆動のRSSフィード提案を受け取りたい。そうすることで、手動検索なしに関連するコンテンツソースを素早く見つけられる。

#### 受入基準

1. MyRSSPressシステムがテーマキーワードを受け取ったとき、MyRSSPressシステムは関連するRSSフィードURLのリストを生成しなければならない
2. フィード提案が生成されたとき、MyRSSPressシステムは提案されたフィードを既存のフィードリストに自動的に追加しなければならない
3. フィードを追加するとき、MyRSSPressシステムは既にリストに存在するフィードの重複追加を防止しなければならない
4. 提案が完了したとき、MyRSSPressシステムは興味入力フィールドをクリアしなければならない

### 要件4: 他のユーザーが作成した新聞表示

**ユーザーストーリー:** ユーザーとして、他のユーザーが作成した新聞を閲覧したい。そうすることで、インスピレーションを得たり、興味深いコンテンツを発見したりできる。

#### 受入基準

1. ホーム画面を表示するとき、MyRSSPressシステムは人気の新聞セクションを表示しなければならない
2. 人気の新聞を表示するとき、MyRSSPressシステムは並び替えオプションを提供しなければならない
3. 並び替えオプションを提供するとき、MyRSSPressシステムは「人気順（閲覧数の多い順）」と「新着順（作成日時の降順）」の2つの選択肢を含めなければならない
4. ユーザーが並び替えオプションを選択したとき、MyRSSPressシステムは選択された順序で新聞リストを即座に更新しなければならない
5. 各新聞カードを表示するとき、MyRSSPressシステムはサムネイル画像、タイトル、作成者名、作成日、トピックタグ、閲覧数を含めなければならない
6. ユーザーが新聞カードをクリックしたとき、MyRSSPressシステムはその新聞の詳細ページに遷移しなければならない

### 要件5: 新聞生成

**ユーザーストーリー:** ユーザーとして、選択したフィードから新聞を生成したい。そうすることで、最近の記事を整理された視覚的に魅力的な形式で閲覧できる。

#### 受入基準

1. ユーザーが新聞生成を開始したとき、MyRSSPressシステムは少なくとも1つのフィードが選択されていることを検証しなければならない
2. フィードが選択されていないとき、MyRSSPressシステムはエラーメッセージを表示しなければならない
3. ユーザーが新聞生成を開始したとき、MyRSSPressシステムはRSS公開日に基づいて最新の記事を優先的に取得しなければならない
4. 記事を取得するとき、MyRSSPressシステムは8〜15記事をランダムに選択しなければならない
5. 最新3日間の記事が最小記事数（8記事）に満たないとき、MyRSSPressシステムは過去7日間まで遡って記事を取得しなければならない
6. 過去7日間でも最小記事数に満たないとき、MyRSSPressシステムは取得できたすべての記事を表示しなければならない
5. 取得した記事が8記事未満のとき、MyRSSPressシステムは過去7日間まで遡って記事を取得しなければならない
6. 過去7日間でも8記事未満のとき、MyRSSPressシステムは取得できたすべての記事で新聞を生成しなければならない
7. 記事を取得するとき、MyRSSPressシステムはタイトル、説明、リンク、画像を含むRSSフィードコンテンツを解析しなければならない
8. 記事が収集されたとき、MyRSSPressシステムはコンテンツを分析して記事の重要度を決定しなければならない
9. 生成が完了したとき、MyRSSPressシステムは収集されたすべての記事を含む新聞ページを表示しなければならない
10. 生成プロセスが実行されるとき、MyRSSPressシステムは5秒以内に完了しなければならない

### 要件6: 新聞設定とメタデータ

**ユーザーストーリー:** ユーザーとして、新聞生成後にユーザー名と新聞名を指定したい。そうすることで、新聞をパーソナライズできる。

#### 受入基準

1. 新聞が生成されたとき、MyRSSPressシステムは保存ボタンを表示しなければならない
2. ユーザーが保存ボタンをクリックしたとき、MyRSSPressシステムは設定モーダルを表示しなければならない
3. 設定モーダルを表示するとき、MyRSSPressシステムはユーザー名入力フィールドと新聞名入力フィールドを含めなければならない
4. ユーザーが新聞名を入力しないとき、MyRSSPressシステムはデフォルトの新聞名を自動的に設定しなければならない
5. ユーザーが設定を保存したとき、MyRSSPressシステムはモーダルを閉じて新聞ページに設定を反映しなければならない
6. 新聞が保存されたとき、MyRSSPressシステムは保存済みステータスを表示しなければならない
7. 新聞ページを表示するとき、MyRSSPressシステムは新聞名、作成日、ユーザー名（設定されている場合）を新聞レイアウト内のヘッダー部分に表示しなければならない

### 要件7: 紙テクスチャデザイン

**ユーザーストーリー:** ユーザーとして、新聞が本物の紙のように見えてほしい。そうすることで、没入感のある読書体験を楽しめる。

#### 受入基準

1. 新聞ページがレンダリングされるとき、MyRSSPressシステムは背景にリアルな紙のテクスチャを適用しなければならない
2. テキストコンテンツを表示するとき、MyRSSPressシステムは伝統的な新聞のタイポグラフィに似たセリフフォントを使用しなければならない
3. ページをスタイリングするとき、MyRSSPressシステムはすべての新聞要素にわたって一貫した視覚的テーマを維持しなければならない
4. ページが読み込まれるとき、MyRSSPressシステムはテクスチャアセットが初期レンダリングを2秒以上遅延させないことを保証しなければならない

### 要件8: 自動レイアウト

**ユーザーストーリー:** ユーザーとして、記事が様々なサイズで自動的に配置されてほしい。そうすることで、重要なコンテンツが視覚的に目立つ。

#### 受入基準

1. 記事の重要度を計算するとき、MyRSSPressシステムはAWS Bedrock（Claude 3.5 Haiku）を使用しなければならない
2. 重要度を計算するとき、MyRSSPressシステムはユーザーのテーマキーワードと記事の関連性を最優先で考慮しなければならない
3. 重要度を計算するとき、MyRSSPressシステムは画像の有無を考慮しなければならない（画像付きは+10点のボーナス）
4. Bedrock APIが失敗したとき、MyRSSPressシステムはフォールバックアルゴリズム（タイトル長と画像有無）を使用しなければならない
5. 記事をレイアウトするとき、MyRSSPressシステムはより高い重要度の記事により大きな見出しサイズを割り当てなければならない
6. 記事を配置するとき、MyRSSPressシステムはより高い重要度の記事をより目立つ位置に配置しなければならない
7. 最も重要度の高い記事を表示するとき、MyRSSPressシステムはリード記事として大きく表示しなければならない
8. 次に重要度の高い記事を表示するとき、MyRSSPressシステムはトップストーリーとして3カラムレイアウトで表示しなければならない
9. 残りの記事を表示するとき、MyRSSPressシステムは2カラムレイアウトで表示しなければならない
10. レイアウトが生成されるとき、MyRSSPressシステムは選択されたすべての記事がページ上に表示されることを保証しなければならない

### 要件9: ナビゲーションとユーザーフロー

**ユーザーストーリー:** ユーザーとして、新聞ページからホーム画面に戻りたい。そうすることで、新しい新聞を作成したり、他の新聞を閲覧したりできる。

#### 受入基準

1. 新聞ページを表示しているとき、MyRSSPressシステムはホームに戻るボタンを表示しなければならない
2. ユーザーがホームに戻るボタンをクリックしたとき、MyRSSPressシステムは統合ホーム画面に遷移しなければならない
3. ホーム画面にデモボタンを表示するとき、MyRSSPressシステムはクリックで事前設定されたフィードを使用してデモ新聞を生成しなければならない

### 要件10: パフォーマンス要件

**ユーザーストーリー:** デモプレゼンターとして、新聞生成が素早く完了してほしい。そうすることで、ハッカソンデモ中に遅延なくシステムを紹介できる。

#### 受入基準

1. 新聞生成プロセスが実行されるとき、MyRSSPressシステムはすべての処理を5秒以内に完了しなければならない
2. 複数のフィードが選択されたとき、MyRSSPressシステムは合計時間を最小化するためにフィードを並行して取得および処理しなければならない
3. システムが高負荷を経験するとき、MyRSSPressシステムは生成時間を8秒未満に維持しなければならない
4. 生成が進行中のとき、MyRSSPressシステムはユーザーに進行状況インジケーターを表示しなければならない

### 要件11: レスポンシブデザイン

**ユーザーストーリー:** ユーザーとして、モバイルデバイスでもアプリケーションを快適に使用したい。そうすることで、どのデバイスからでもアクセスできる。

#### 受入基準

1. 画面サイズが変更されたとき、MyRSSPressシステムはレイアウトを適切に調整しなければならない
2. モバイルデバイスで表示するとき、MyRSSPressシステムは3カラムレイアウトを1カラムに変更しなければならない
3. タブレットデバイスで表示するとき、MyRSSPressシステムは適切なブレークポイントでレイアウトを調整しなければならない
4. すべてのデバイスで表示するとき、MyRSSPressシステムはテキストの可読性を維持しなければならない

### 要件12: テスト要件

**ユーザーストーリー:** 開発者として、コードの品質を保証するための包括的なテストを実装したい。そうすることで、バグを早期に発見し、リファクタリングを安全に行える。

#### 受入基準

1. フロントエンドコンポーネントを実装するとき、MyRSSPressシステムはユニットテストを含めなければならない
2. バックエンドAPIを実装するとき、MyRSSPressシステムはユニットテストと統合テストを含めなければならない
3. 主要なユーザーフローを実装するとき、MyRSSPressシステムはPlaywrightを使用したE2Eテストを含めなければならない
4. E2Eテストを実装するとき、MyRSSPressシステムは以下のシナリオをカバーしなければならない：
   - 新聞作成フロー（テーマ入力 → フィード提案 → 新聞生成）
   - 手動フィード追加と削除
   - 新聞設定の保存
   - 人気の新聞の閲覧と並び替え
   - レスポンシブデザインの動作確認
5. テストを実装するとき、MyRSSPressシステムはPage Object Modelパターンを使用しなければならない
6. テストを実行するとき、MyRSSPressシステムは複数のブラウザ（Chrome、Firefox、Safari）で動作を検証しなければならない
7. テストカバレッジを測定するとき、MyRSSPressシステムは60%以上のカバレッジを達成しなければならない
8. CI/CDパイプラインを実行するとき、MyRSSPressシステムはすべてのテスト（ユニット、統合、E2E、セキュリティ）を自動実行しなければならない

### 要件13: セキュリティ要件

**ユーザーストーリー:** 開発者として、機密情報の漏洩を防ぎたい。そうすることで、セキュリティインシデントを未然に防げる。

#### 受入基準

1. コードをコミットするとき、MyRSSPressシステムはGitleaksを使用して機密情報をチェックしなければならない
2. 機密情報が検出されたとき、MyRSSPressシステムはコミットを拒否しなければならない
3. 環境変数を管理するとき、MyRSSPressシステムは`.env.local`ファイルを`.gitignore`に含めなければならない
4. AWS認証情報を使用するとき、MyRSSPressシステムは環境変数またはAWS Secrets Managerで管理しなければならない
5. APIエンドポイントを実装するとき、MyRSSPressシステムは入力データのバリデーションとサニタイゼーションを実行しなければならない
6. CORSを設定するとき、MyRSSPressシステムは許可されたオリジンのみを受け入れなければならない
